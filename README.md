# WORK IN PROGRESS
The code still needs cleaning and more implementation

# MalwareTracesPythonServer
Python server that manages the analysis of network requests made by a specified program using [MalwareTracesDll](https://github.com/d3af90d/MalwareTracesDll) and [MalwareTracesInjector](https://github.com/d3af90d/MalwareTracesInjector)

## Usage
The files in this repository must be placed in the folder `C:\malwareTraces\`

After installing the required dependencies, just start the server
```powershell
python3.exe .\server.py
```

All the binaries required by the server are already compiled.

## API Endpoints

- `/upload` - POST

Upload an executable with a POST request.

```bash
curl -X POST -F "file=@/home/user/program.exe" http://pyserver.ip/upload
```

- `/download` - POST

Make the server download an executable from a web server.

```bash
curl -i -XPOST --data 'url=https://example.com/program.exe' https://pyserver.ip/download
```

- `/start` - POST JSON

Start the analysis process.

If you specify only a filename, the program to analyze is searched in the `\uploads` folder.

The folder contains files uploaded by the user with the `\upload` and `\download` APIs.

```bash
curl -i -H "Content-Type: application/json" -XPOST --data '{"command" : "program.exe", "args" : ""}' http://pyserver.ip/start
```

If a full path is specified, any system program can be analyzed.

```bash
curl -i -H "Content-Type: application/json" -XPOST --data '{"command" : "C:/Windows/System32/ping.exe", "args" : "-a -n 3 google.com"}' http://pyserver.ip/start
```

- `/check` - GET

Check if the analysis process is running. The server answers `200` if it's running, `404` otherwise.

```bash
curl -i -XGET 'http://pyserver.ip/check'
```

- `/result` - GET

Get a `result.zip` containing the network capture PCAP and a CSV with the informations of the specified program network requets.

```bash
curl -XGET 'http://pyserver.ip/result' > result.zip
```




